<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Football Clubs Map</title>
    <style>
      /* Ensure the map takes up the full viewport */
      #map {
        height: 100vh;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <script>
  function initMap() {
    var map = new google.maps.Map(document.getElementById("map"), {
        zoom: 7,
        center: { lat: 41.5, lng: 2.1 },  // Adjust this to center around your data
        mapId: "6d21538ba521f729"
    });

    // Load the CSV file from GitHub
    fetch("https://raw.githubusercontent.com/gabort-maps/football-maps/main/clubs.csv")
        .then(response => response.text())
        .then(data => {
            const rows = data.split("\n").slice(1); // Remove header
            rows.forEach(row => {
                const columns = row.split(",");
                if (columns.length >= 4) { // Ensure it's a valid row
                    const name = columns[0].trim();
                    const lat = parseFloat(columns[1]);
                    const lng = parseFloat(columns[2]);
                    const players = parseInt(columns[3]);

                    // Calculate marker size based on player count
                    const markerSize = Math.min(80, 30 + players / 20); // Limits max size to 80px

                    // Create the custom icon with dynamic size
                    const customIcon = document.createElement("img");
                    customIcon.src = "https://raw.githubusercontent.com/gabort-maps/football-maps/main/gtphoto%20(1).JPG"; // Use your custom image
                    customIcon.style.width = markerSize + "px";
                    customIcon.style.height = markerSize + "px";

                    // Add marker to the map
                    const marker = new google.maps.marker.AdvancedMarkerElement({
                        map: map,
                        position: { lat: lat, lng: lng },
                        title: name,
                        content: customIcon
                    });
                }
            });
        })
        .catch(error => console.error("Error loading CSV:", error));
}


    </script>

    <!-- Ensure this script is loaded last -->
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCXOfD-urA6wwow_1mz0O-bSJ9PjwXylhQ&callback=initMap&libraries=marker">
    </script>
  </body>
</html>
